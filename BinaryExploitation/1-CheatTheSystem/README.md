# Cheat The System - Binary Exploitation

Oh no! Evil Insurance Company Mario is back at it again! This time he stole Luigi's gun! Insurance companies always find a way to cheat the system.

But fire must be fought with fire. Can you stop Mario by helping Luigi capture the blue flag before Mario turns his pistol into an AR 15?

Shared Objects if you need them (x86_64): https://www.mediafire.com/file/95czilsmb8zkvcm/shared-objects-mario-game.zip/file

FLAG: `parsec{ch34t1ng_i5nt_50_b4d_$82aOz#Iv5}`

### INSTRUCTIONS TO USE .so FILES:
1. Unzip lib.zip into `game-libs`
2. `export LD_LIBRARY_PATH=$PWD/game-libs:$LD_LIBRARY_PATH` (works only for the current shell)
3. `./mario`

# Exploiting the binary

1. As mentioned above, one way to get the flag is just cheat using memory editor tools.
2. We will be using gameconqueror (available on Linux) for this challenge.
3. NOTE: We do not condone hacking in games. This is purely for educational purposes.
4. Open a terminal, run `./mario` and imemdiately press `Ctrl+Z` to stop the running process.
5. Open another terminal and get the Process ID of the game using `ps aux | grep mario`
6. Run `sudo gameconqueror <mario-process-id>`.
7. In the `Value` field: type in `5`. (The current health of Mario).
8. Click on the scan button.
9. We see a list of memory addresses with the value 5.
10. Go back to Terminal 1 and type in `fg` to get the game running. Let Luigi shoot Mario once and immediately stop the process again using `Ctrl+Z`.
11. In `gameconqueror`, rescan the memory for the value 4. A single address should show up.
12. In the Value column at the lower half, double click and edit it to a high value (say 10000).
13. In terminal 1, enter `fg` again to run the game. Now you must see a very high health value. You can capture the blue flag without dying if the number is sufficiently large.
14. https://www.greasyguide.com/linux/use-gameconqueror-cheat-engine-linux/
15. Note that this is just one way to capture the flag, you can also reverse engineer the decode function or change the initial health value in the binary. However this is a bit hard as the binary is stripped of symbols.