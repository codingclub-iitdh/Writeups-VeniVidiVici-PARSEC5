# Sprint Sprint Sprint! - Binary Exploitation
This is the README for Binary Exploitation/2.

FLAG: parsec{8ug_f1x35_4nd_73571ng_49MXDZ35fH}

## Challenge Overview

In this challenge, we are tasked with analyzing a C program that simulates a software development lifecycle. The objective is to exploit vulnerabilities in the program to uncover a hidden flag.

## Analyzing the Code

Upon inspection of the provided C code, we can identify several stages of the software development process, including analysis, design, implementation, testing, deployment, and maintenance. 
Notice that the `testing` stage is never entered into.
The key focus for exploitation lies in the `testing` stage, where user input is processed.

### Vulnerability Breakdown

1. **Buffer Overflow**: The program uses `scanf("%s", name);` to read user input for the user's name during the `maintenance` phase without any length restriction. This can lead to a buffer overflow. If a user inputs more than 64 characters, it can overwrite adjacent memory.

2. **Ordering of stack variables**: GCC Compiled programs store stack variables (at least, arrays) in decreasing order of size towards the top of the stack. Here, the stack is as shown.

```
           TOP
    |              | Lower memory addresses (towards 0)
    |              |
    +--------------+
    |name[64]      | 
    +--------------+
    |feedback[128] |
    |              |
    |              |
    +--------------+
    |stage[256]    |
    |              |
    |              |
    +--------------+
    |fuzzinput[512]|
    |              |
    |              |
    |              |
    +--------------+ Higher memory addresses (towards 2^n)
```

3. **Buffer Manipulation**: By overflowing the `name` buffer, we can manipulate the `stage` variable. If we overwrite the `stage` string with "testing", we can bypass the normal flow of the program and directly enter the `testing` stage.

4. **Input Processing**: In the `testing` stage, the program prompts the user for input and calls the `process_input` function. The `is_match` function is a placeholder that is unimplemented always returns 1. Any input provided will be considered valid.

5. **Format String Vulnerability**: The `process_input` function uses `printf(strcat(provided, " %s"), "is valid!");`. This creates a format string vulnerability, allowing us to print the contents of the `actual` variable (which contains the flag) by carefully crafting our input.

By trial and error, the string input "%x%x%x%x%x%x%s" walks up the stack and prints out the flag.